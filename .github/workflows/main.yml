name: Run signup.py and login.py on schedule

on:
  workflow_dispatch:  # âœ… ìˆ˜ë™ ì‹¤í–‰ ì¶”ê°€
  schedule:
    - cron: '0 10 * * *'  # ë§¤ì¼ ì˜¤ì „ 10ì‹œ ì‹¤í–‰

jobs:
  run-scripts:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout code
        uses: actions/checkout@v3

      - name: Set up Python
        uses: actions/setup-python@v4
        with:
          python-version: 3.8

      - name: Add Cube-X domain to /etc/hosts
        run: |
          echo "61.251.164.234 cubex.seowoninfo.com" | sudo tee -a /etc/hosts
          echo "ğŸ” /etc/hosts ë‚´ìš© í™•ì¸:"
          cat /etc/hosts  # Debugging: hosts íŒŒì¼ì´ ì •ìƒì ìœ¼ë¡œ ì¶”ê°€ë˜ì—ˆëŠ”ì§€ í™•ì¸

      - name: Test Network Connectivity
        run: |
          echo "ğŸ” DNS í™•ì¸ (nslookup)"
          nslookup cubex.seowoninfo.com || echo "âŒ DNS Resolution Failed"

          echo "ğŸ” ì‚¬ì´íŠ¸ ì ‘ì† í…ŒìŠ¤íŠ¸ (ping)"
          ping -c 4 cubex.seowoninfo.com || echo "âŒ Ping ì‹¤íŒ¨"

          echo "ğŸ” ì‚¬ì´íŠ¸ ìƒíƒœ í™•ì¸ (curl -I)"
          curl -I https://cubex.seowoninfo.com/auth || echo "âŒ Website Unreachable"

          echo "ğŸ” ì§ì ‘ ì—°ê²° ì‹œë„ (wget --spider)"
          wget --spider https://cubex.seowoninfo.com/auth || echo "âŒ Website is not reachable"

      - name: Install Chrome
        run: |
          sudo apt update
          sudo apt install -y google-chrome-stable

      - name: Install dependencies
        run: pip install selenium chromedriver-autoinstaller requests

      - name: Check Website Availability before running Selenium
        run: |
          if curl -s --head https://cubex.seowoninfo.com/auth | grep "200 OK" > /dev/null; then
            echo "âœ… ì‚¬ì´íŠ¸ ì ‘ê·¼ ê°€ëŠ¥, Selenium ì‹¤í–‰ ê°€ëŠ¥"
          else
            echo "âŒ ì‚¬ì´íŠ¸ ì ‘ê·¼ ë¶ˆê°€, Selenium ì‹¤í–‰ì„ ì¤‘ë‹¨í•©ë‹ˆë‹¤."
            exit 1
          fi

      - name: Run signup.py
        run: python signup.py
